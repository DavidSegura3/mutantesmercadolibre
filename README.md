
# mutantesmercadolibre
Paso a paso para ejecutar la aplicación:

1. Instalar PostgreSQL(Si ya tiene instalado Postgres omitir este paso)
- Al momento de instalar tener en cuenta la siguiente configuración del motor de base de datos:
- usuario: postgres
- contrasena: admin

2. Luego de instalar el motor de base de datos debe:

- Crear base de datos mutantes.

Una vez creada la base de datos ejecutar los siguientes queries:

- create schema mutante;

- CREATE TABLE mutante.humano
(
    id bigint 				NOT NULL GENERATED BY DEFAULT AS IDENTITY,
    adn varchar(100) 		NOT NULL,
    mutante Boolean			NOT NULL,
    CONSTRAINT humano_pk PRIMARY KEY (id),
    CONSTRAINT humano_uk unique (adn)
)

3. Clonar y descargar los siguientes proyectos:

- git clone https://github.com/DavidSegura3/eurekaservermutante.git
- git clone https://github.com/DavidSegura3/mutantesmercadolibre.git
- git clone https://github.com/DavidSegura3/gatewayservermutant.git


4. Una vez clonados hacer checkout de la rama develop de los tres proyectos clonados anteriormente.

5. Validar el usuario y la contraseña de la base de datos, por defecto tengo los siguientes valores en el archivo de application.properties.

- spring.datasource.username=postgres
- spring.datasource.password=admin

Si tiene valores diferentes cambiar el archivo application.propierties del proyecto mutantesmercadolibre que se encuentra en la ruta src\main\resources



6. Importar los proyectos como MAVEN en la IDE eclipse, spring tool suite o intellij, 

**Tener en cuenta que el proyecto MELIMutant utiliza para la entidad la librería lombook, si no la tiene en la ide, por favor instalarla.**


7. Ejecutar los proyectos **run as spring boot app** en el siguiente orden:

- EurekaServerMutant
- MELIMutant (Puede crear las instancias necesarias para que Eureka Server utilice el balancero de carga)
- GatewayServerMutant


8. Una vez los proyectos se encuentren arriba se deben ejecutar los siguientes endpoints en postman o soapUI

**El primer endpoint es para analizar el array y agregar los valores y determinar los mutantes**
Endpoint de tipo POST:
- http://localhost:8090/api/mutantes/mutant
- Body:
{
    "adn" : [
        "CTGCGA", "CCGTAA", "TTCAGT", "AGACGG", "CCCCTA", "TCACTG"
    ]
}

**El segundo endpoint es sacar las estadisticas de humanos vs mutantes**
Endpoint de tipo GET:
- http://localhost:8090/api/mutantes/stats



-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------


**Explicación proyectos y una parte del código**


1. EurekaServerMutant - **Servidor Eureka**

Cuando arrancamos el servicio MELIMutantes, se comunicará con el servidor Eureka para notificarle que está disponible para ser consumido. El servidor Eureka mantendrá la información del microservicio registrado y su estado. MELIMutantes le notificará su estado mediante heartbeats cada 30 segundos. Si pasados tres periodos heartbeats no recibe ninguna notificación del microservicio, lo eliminará de su registro. Al igual que si después de sacarlo del registro recibe tres notificaciones, entenderá que ese microservicio vuelve a estar disponible. 


2. MELIMutant - **Microservicio** 

- Valido la longitud del array.
- Valido que el array sea de NxN.
- Valido que el los caracteres ingresados sean los permitodos(A - T - C - G).
- Luego de esas validaciones empiezo paso seguido es validar si existe alguna secuencia de manera horizontal, verticual y oblicua(izquierda/derecha).


3. GatewayServerMutant - **Spring Cloud Gateway**

El siguiente diagrama proporciona una descripción general de alto nivel de cómo funciona Spring Cloud Gateway:

![image](https://user-images.githubusercontent.com/48692997/130154942-80a637c0-95fe-4fde-95c8-7c1fe5a6af79.png)


Imagen sacada de: https://cloud.spring.io/spring-cloud-gateway/reference/html/



Eureka server realiza solicitudes a Spring Cloud Gateway. Si la asignación del controlador de la puerta de enlace determina que una solicitud coincide con una ruta, se envía al controlador web de la puerta de enlace. 


El funcionamiento de como vamos a trabajar en este proyecto, la siguiente imagen lo define mejor, por si no me hice entender.


![image](https://user-images.githubusercontent.com/48692997/130154180-b3976a93-37ec-48f9-b2a6-0231ea7fe350.png)



En la imagen aparece Gateway zull, yo estoy utilizando **Spring Cloud Gateway**, adicional solo tengo un servicio con balanceo de carga y se llama MELIMutant.






> @Author - David Segura - 20-08-2021.
